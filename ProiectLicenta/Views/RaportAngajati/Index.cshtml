@using ProiectLicenta.Models
@using ProiectLicenta.ViewModels
@{
    ViewData["Title"] = "Raport Angajati";
}

@model IEnumerable<RaportAngajati>;

<h1 class="fw-bold pb-2 pb-xl-3 text-center">Raport Angajati</h1>

<div>
    <input class="btn btn-warning mb-3" type="button" value="Inapoi" onclick="@("window.location.href='" + @Url.Action("Index", "Home") + "'");" />

    <form method="get" action="@Url.Action("Index")">
        <div class="form-group mb-3">
            <select class="form-select form-control-lg" asp-items="ViewBag.Angajati" name="angajatSelectat">
                <option value="0" hidden>Alege Angajat</option>
            </select>
        </div>
        <div class="form-group mb-3">
            <select class="form-select form-control-lg" asp-items="ViewBag.Registers" name="registruSelectat">
                <option value="" hidden>Alege Registru</option>
            </select>
        </div>
        <input class="btn btn-primary" type="submit" value="Cauta" />
    </form>

    @if (Model != null && Model.Any())
    {
        int totalIrigare = 0;
        int totalFertilizare = 0;
        int totalPalisare = 0;
        int totalCopilire = 0;
        int totalTratamente = 0;
        int totalRecoltare = 0;

        <table class="table">
            <thead>
                <tr>
                    <th style="width: 10%;">Cod Angajat</th>
                    <th style="width: 20%;">Nume Angajat</th>
                    <th>Registru</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.CodAngajat</td>
                        <td>@item.Nume @item.Prenume</td>
                        <td>
                            @if (item.RegistruCopilire != null)
                            {
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Cod Copilire</th>
                                            <th>Numar Plante</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var variabila in item.RegistruCopilire)
                                        {
                                            <tr>
                                                <td>@variabila.CodCopilire</td>
                                                <td>@variabila.NumarPlante</td>
                                            </tr>
                                            totalCopilire += variabila.NumarPlante;
                                        }
                                        <tr>
                                            <td>Total</td>
                                            <td>@totalCopilire</td>
                                        </tr>
                                    </tbody>
                                </table>
                            }
                            else if (item.RegistruFertilizare != null)
                            {
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Cod Fertilizare</th>
                                            <th>Suprafata</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var variabila in item.RegistruFertilizare)
                                        {
                                            <tr>
                                                <td>@variabila.CodFertilizare</td>
                                                <td>@variabila.Suprafata</td>
                                            </tr>
                                            totalFertilizare += variabila.Suprafata;
                                        }
                                        <tr>
                                            <td>Total</td>
                                            <td>@totalFertilizare</td>
                                        </tr>
                                    </tbody>
                                </table>
                            }
                            else if (item.RegistruIrigare != null)
                            {
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Cod Irigare</th>
                                            <th>Durata Irigare</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var variabila in item.RegistruIrigare)
                                        {
                                            <tr>
                                                <td>@variabila.CodIrigare</td>
                                                <td>@variabila.DurataIrigare</td>
                                            </tr>
                                            totalIrigare += variabila.DurataIrigare;
                                        }
                                        <tr>
                                            <td>Total</td>
                                            <td>@totalIrigare</td>
                                        </tr>
                                    </tbody>
                                </table>
                            }
                            else if (item.RegistruPalisare != null)
                            {
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Cod Palisare</th>
                                            <th>Numar Plante</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var variabila in item.RegistruPalisare)
                                        {
                                            <tr>
                                                <td>@variabila.CodPalisare</td>
                                                <td>@variabila.NumarPlante</td>
                                            </tr>
                                            totalPalisare += variabila.NumarPlante;
                                        }
                                        <tr>
                                            <td>Total</td>
                                            <td>@totalPalisare</td>
                                        </tr>
                                    </tbody>
                                </table>
                            }
                            else if (item.RegistruRecoltare != null)
                            {
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Cod Recoltare</th>
                                            <th>Cantitate Recoltata</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var variabila in item.RegistruRecoltare)
                                        {
                                            <tr>
                                                <td>@variabila.CodRecoltare</td>
                                                <td>@variabila.CantitateRecoltata</td>
                                            </tr>
                                            totalRecoltare += variabila.CantitateRecoltata;
                                        }
                                        <tr>
                                            <td>Total</td>
                                            <td>@totalRecoltare</td>
                                        </tr>
                                    </tbody>
                                </table>
                            }
                            else if (item.RegistruTratamente != null)
                            {
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Cod Tratament Aplicat</th>
                                            <th>Suprafata</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var variabila in item.RegistruTratamente)
                                        {
                                            <tr>
                                                <td>@variabila.CodTratamentAplicat</td>
                                                <td>@variabila.Suprafata</td>
                                            </tr>
                                            totalTratamente += variabila.Suprafata;
                                        }
                                        <tr>
                                            <td>Total</td>
                                            <td>@totalTratamente</td>
                                        </tr>
                                    </tbody>
                                </table>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {<br />
        <p>Nu exista date!</p>
    }
</div>
